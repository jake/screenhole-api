require 'open-uri'
require 'fileutils'

namespace :backport do
  task shots: :environment do
    FileUtils::mkdir_p 'tmp/backport'

    data = {"title":"live-holes","fields":["id","author","filename","created_at","updated_at"],"types":[20,1043,1043,1114,1114],"type_names":["integer","text","text","unknown","unknown"],"values":[[1,"pasquale","pasquale/1507147531.png","2017-10-04 20:05:31.453975","2017-10-04 20:05:31.453975"],[2,"pasquale","pasquale/1507148129.png","2017-10-04 20:15:30.085532","2017-10-04 20:15:30.085532"],[3,"pasquale","pasquale/1507148258.png","2017-10-04 20:17:38.582703","2017-10-04 20:17:38.582703"],[4,"jacob","jacob/1507150220.png","2017-10-04 20:50:20.617093","2017-10-04 20:50:20.617093"],[5,"jacob","jacob/1507150853.png","2017-10-04 21:00:54.002053","2017-10-04 21:00:54.002053"],[6,"jacob","jacob/1507151156.png","2017-10-04 21:05:56.612921","2017-10-04 21:05:56.612921"],[7,"jacob","jacob/1507151170.png","2017-10-04 21:06:11.107786","2017-10-04 21:06:11.107786"],[8,"jacob","jacob/1507151181.png","2017-10-04 21:06:21.267911","2017-10-04 21:06:21.267911"],[9,"jacob","jacob/1507151193.png","2017-10-04 21:06:33.667434","2017-10-04 21:06:33.667434"],[10,"jacob","jacob/1507151655.png","2017-10-04 21:14:16.054008","2017-10-04 21:14:16.054008"],[11,"pasquale","pasquale/1507153174.png","2017-10-04 21:39:34.261269","2017-10-04 21:39:34.261269"],[12,"pasquale","pasquale/1507153836.png","2017-10-04 21:50:36.874632","2017-10-04 21:50:36.874632"],[13,"pasquale","pasquale/1507154270.png","2017-10-04 21:57:50.522166","2017-10-04 21:57:50.522166"],[14,"pasquale","pasquale/1507154332.png","2017-10-04 21:58:52.896284","2017-10-04 21:58:52.896284"],[15,"pasquale","pasquale/1507154380.png","2017-10-04 21:59:40.23061","2017-10-04 21:59:40.23061"],[16,"pasquale","pasquale/1507154402.png","2017-10-04 22:00:02.656375","2017-10-04 22:00:02.656375"],[17,"pasquale","pasquale/1507154422.png","2017-10-04 22:00:22.302318","2017-10-04 22:00:22.302318"],[18,"pasquale","pasquale/1507154446.png","2017-10-04 22:00:47.067178","2017-10-04 22:00:47.067178"],[19,"pasquale","pasquale/1507154852.png","2017-10-04 22:07:32.936374","2017-10-04 22:07:32.936374"],[20,"pasquale","pasquale/1507155478.png","2017-10-04 22:17:58.185212","2017-10-04 22:17:58.185212"],[21,"pasquale","pasquale/1507156510.png","2017-10-04 22:35:10.239068","2017-10-04 22:35:10.239068"],[22,"pasquale","pasquale/1507156705.png","2017-10-04 22:38:25.61154","2017-10-04 22:38:25.61154"],[23,"pasquale","pasquale/1507157768.png","2017-10-04 22:56:08.823027","2017-10-04 22:56:08.823027"],[24,"pasquale","pasquale/1507158253.png","2017-10-04 23:04:13.42686","2017-10-04 23:04:13.42686"],[25,"jacob","jacob/1507158453.png","2017-10-04 23:07:33.610599","2017-10-04 23:07:33.610599"],[26,"pasquale","pasquale/1507158537.png","2017-10-04 23:08:57.894262","2017-10-04 23:08:57.894262"],[27,"pasquale","pasquale/1507160599.png","2017-10-04 23:43:20.020531","2017-10-04 23:43:20.020531"],[28,"pasquale","pasquale/1507160757.png","2017-10-04 23:45:57.618303","2017-10-04 23:45:57.618303"],[29,"pasquale","pasquale/1507160774.png","2017-10-04 23:46:14.97","2017-10-04 23:46:14.97"],[30,"pasquale","pasquale/1507160795.png","2017-10-04 23:46:35.94024","2017-10-04 23:46:35.94024"],[31,"pasquale","pasquale/1507160823.png","2017-10-04 23:47:03.161955","2017-10-04 23:47:03.161955"],[32,"pasquale","pasquale/1507160835.png","2017-10-04 23:47:15.406476","2017-10-04 23:47:15.406476"],[33,"pasquale","pasquale/1507214799.png","2017-10-05 14:46:40.049555","2017-10-05 14:46:40.049555"],[34,"jacob","jacob/1507228071.png","2017-10-05 18:27:52.066985","2017-10-05 18:27:52.066985"],[35,"pasquale","pasquale/1507229716.png","2017-10-05 18:55:16.640596","2017-10-05 18:55:16.640596"],[36,"pasquale","pasquale/1507230737.png","2017-10-05 19:12:17.811287","2017-10-05 19:12:17.811287"],[37,"pasquale","pasquale/1507238222.png","2017-10-05 21:17:02.617649","2017-10-05 21:17:02.617649"],[38,"jacob","jacob/1507238882.png","2017-10-05 21:28:02.636137","2017-10-05 21:28:02.636137"],[39,"pasquale","pasquale/1507239663.png","2017-10-05 21:41:03.596855","2017-10-05 21:41:03.596855"],[40,"pasquale","pasquale/1507303641.png","2017-10-06 15:27:21.594753","2017-10-06 15:27:21.594753"],[41,"jacob","jacob/1507303806.png","2017-10-06 15:30:06.978718","2017-10-06 15:30:06.978718"],[42,"pasquale","pasquale/1507304691.png","2017-10-06 15:44:51.775184","2017-10-06 15:44:51.775184"],[43,"pasquale","pasquale/1507312448.png","2017-10-06 17:54:08.831684","2017-10-06 17:54:08.831684"],[44,"pasquale","pasquale/1507313361.png","2017-10-06 18:09:22.041005","2017-10-06 18:09:22.041005"],[45,"pasquale","pasquale/1507313983.png","2017-10-06 18:19:43.984482","2017-10-06 18:19:43.984482"],[46,"pasquale","pasquale/1507314937.png","2017-10-06 18:35:37.854812","2017-10-06 18:35:37.854812"],[47,"pasquale","pasquale/1507316306.png","2017-10-06 18:58:26.928942","2017-10-06 18:58:26.928942"],[48,"pasquale","pasquale/1507321321.png","2017-10-06 20:22:01.36833","2017-10-06 20:22:01.36833"],[49,"pasquale","pasquale/1507321451.png","2017-10-06 20:24:12.118844","2017-10-06 20:24:12.118844"],[50,"pasquale","pasquale/1507321838.png","2017-10-06 20:30:38.846618","2017-10-06 20:30:38.846618"],[51,"jacob","jacob/1507322481.png","2017-10-06 20:41:21.423983","2017-10-06 20:41:21.423983"],[52,"jacob","jacob/1507323431.png","2017-10-06 20:57:12.068813","2017-10-06 20:57:12.068813"],[53,"jacob","jacob/1507399753.png","2017-10-07 18:09:13.801471","2017-10-07 18:09:13.801471"],[54,"jacob","jacob/1507400653.png","2017-10-07 18:24:13.523518","2017-10-07 18:24:13.523518"],[55,"jacob","jacob/1507401922.png","2017-10-07 18:45:22.96242","2017-10-07 18:45:22.96242"],[56,"jacob","jacob/1507402034.png","2017-10-07 18:47:14.22662","2017-10-07 18:47:14.22662"],[57,"jacob","jacob/1507402039.png","2017-10-07 18:47:19.069836","2017-10-07 18:47:19.069836"],[58,"pasquale","pasquale/1507402740.png","2017-10-07 18:59:00.271959","2017-10-07 18:59:00.271959"],[59,"pasquale","pasquale/1507405124.png","2017-10-07 19:38:44.784179","2017-10-07 19:38:44.784179"],[60,"pasquale","pasquale/1507408005.png","2017-10-07 20:26:45.623397","2017-10-07 20:26:45.623397"],[61,"jacob","jacob/1507408022.png","2017-10-07 20:27:02.885111","2017-10-07 20:27:02.885111"],[62,"jacob","jacob/1507408219.png","2017-10-07 20:30:20.334771","2017-10-07 20:30:20.334771"],[63,"jacob","jacob/1507408956.png","2017-10-07 20:42:37.050552","2017-10-07 20:42:37.050552"],[64,"pasquale","pasquale/1507409677.png","2017-10-07 20:54:37.148697","2017-10-07 20:54:37.148697"],[65,"pasquale","pasquale/1507409731.png","2017-10-07 20:55:31.760649","2017-10-07 20:55:31.760649"],[66,"pasquale","pasquale/1507410273.png","2017-10-07 21:04:33.631852","2017-10-07 21:04:33.631852"],[67,"krustuna","krustuna/1507411165.png","2017-10-07 21:19:25.528679","2017-10-07 21:19:25.528679"],[68,"krustuna","krustuna/1507411217.png","2017-10-07 21:20:17.659989","2017-10-07 21:20:17.659989"],[69,"krustuna","krustuna/1507411272.png","2017-10-07 21:21:12.616749","2017-10-07 21:21:12.616749"],[70,"pasquale","pasquale/1507411298.png","2017-10-07 21:21:38.225491","2017-10-07 21:21:38.225491"],[71,"pasquale","pasquale/1507412292.png","2017-10-07 21:38:12.884106","2017-10-07 21:38:12.884106"],[72,"pasquale","pasquale/1507412793.png","2017-10-07 21:46:33.363785","2017-10-07 21:46:33.363785"],[73,"jacob","jacob/1507414933.png","2017-10-07 22:22:13.068344","2017-10-07 22:22:13.068344"],[74,"pim","pim/1507415492.png","2017-10-07 22:31:32.40885","2017-10-07 22:31:32.40885"],[75,"pim","pim/1507415699.png","2017-10-07 22:35:00.146917","2017-10-07 22:35:00.146917"],[76,"jacob","jacob/1507417892.png","2017-10-07 23:11:32.969258","2017-10-07 23:11:32.969258"],[77,"jacob","jacob/1507421545.png","2017-10-08 00:12:25.919727","2017-10-08 00:12:25.919727"],[78,"caitlin","caitlin/1507495339.png","2017-10-08 20:42:20.109456","2017-10-08 20:42:20.109456"],[79,"wojtek","wojtek/1507496685.png","2017-10-08 21:04:45.62356","2017-10-08 21:04:45.62356"],[80,"wojtek","wojtek/1507497809.png","2017-10-08 21:23:30.361281","2017-10-08 21:23:30.361281"],[81,"caitlin","caitlin/1507504546.png","2017-10-08 23:15:46.661937","2017-10-08 23:15:46.661937"],[82,"wojtek","wojtek/1507507450.png","2017-10-09 00:04:10.329113","2017-10-09 00:04:10.329113"],[83,"tida","tida/1507510069.png","2017-10-09 00:47:49.668097","2017-10-09 00:47:49.668097"],[84,"mgoldstein","mgoldstein/1507563038.png","2017-10-09 15:30:39.500102","2017-10-09 15:30:39.500102"],[85,"pasquale","pasquale/1507563063.png","2017-10-09 15:31:03.791882","2017-10-09 15:31:03.791882"],[86,"wojtek","wojtek/1507563339.png","2017-10-09 15:35:39.34243","2017-10-09 15:35:39.34243"],[87,"pasquale","pasquale/1507563656.png","2017-10-09 15:40:57.070136","2017-10-09 15:40:57.070136"],[88,"niekdekker","niekdekker/1507564056.png","2017-10-09 15:47:37.024461","2017-10-09 15:47:37.024461"],[89,"mark","mark/1507564219.png","2017-10-09 15:50:19.545784","2017-10-09 15:50:19.545784"],[90,"caitlin","caitlin/1507564449.png","2017-10-09 15:54:09.448043","2017-10-09 15:54:09.448043"],[91,"kunal","kunal/1507565848.png","2017-10-09 16:17:29.327147","2017-10-09 16:17:29.327147"],[92,"ben","ben/1507566047.png","2017-10-09 16:20:47.474951","2017-10-09 16:20:47.474951"],[93,"pasquale","pasquale/1507566119.png","2017-10-09 16:22:00.145874","2017-10-09 16:22:00.145874"],[94,"frederique","frederique/1507566128.png","2017-10-09 16:22:08.816488","2017-10-09 16:22:08.816488"],[95,"pasquale","pasquale/1507566136.png","2017-10-09 16:22:16.655884","2017-10-09 16:22:16.655884"],[96,"jacob","jacob/1507566204.png","2017-10-09 16:23:25.115897","2017-10-09 16:23:25.115897"],[97,"frederique","frederique/1507566241.png","2017-10-09 16:24:01.385745","2017-10-09 16:24:01.385745"],[98,"pasquale","pasquale/1507566362.png","2017-10-09 16:26:02.969947","2017-10-09 16:26:02.969947"],[99,"caitlin","caitlin/1507566393.png","2017-10-09 16:26:33.937437","2017-10-09 16:26:33.937437"],[100,"wojtek","wojtek/1507566555.png","2017-10-09 16:29:15.829789","2017-10-09 16:29:15.829789"],[101,"wojtek","wojtek/1507566896.png","2017-10-09 16:34:56.587381","2017-10-09 16:34:56.587381"],[102,"pasquale","pasquale/1507566953.png","2017-10-09 16:35:53.988192","2017-10-09 16:35:53.988192"],[103,"pasquale","pasquale/1507567050.png","2017-10-09 16:37:30.760783","2017-10-09 16:37:30.760783"],[104,"pim","pim/1507567059.png","2017-10-09 16:37:39.460444","2017-10-09 16:37:39.460444"],[105,"chase","chase/1507567157.png","2017-10-09 16:39:17.973885","2017-10-09 16:39:17.973885"],[106,"caitlin","caitlin/1507567456.png","2017-10-09 16:44:16.485788","2017-10-09 16:44:16.485788"],[107,"chase","chase/1507567709.png","2017-10-09 16:48:29.675932","2017-10-09 16:48:29.675932"],[108,"setpixel","setpixel/1507567822.png","2017-10-09 16:50:22.289246","2017-10-09 16:50:22.289246"],[109,"pasquale","pasquale/1507567971.png","2017-10-09 16:52:51.324906","2017-10-09 16:52:51.324906"],[110,"pasquale","pasquale/1507568034.png","2017-10-09 16:53:54.849749","2017-10-09 16:53:54.849749"],[111,"jruck","jruck/1507568193.png","2017-10-09 16:56:34.152768","2017-10-09 16:56:34.152768"],[112,"pasquale","pasquale/1507568672.png","2017-10-09 17:04:32.833811","2017-10-09 17:04:32.833811"],[113,"pasquale","pasquale/1507568724.png","2017-10-09 17:05:24.988978","2017-10-09 17:05:24.988978"],[114,"skllcrn","skllcrn/1507568887.png","2017-10-09 17:08:08.095386","2017-10-09 17:08:08.095386"],[115,"pasquale","pasquale/1507568893.png","2017-10-09 17:08:14.02582","2017-10-09 17:08:14.02582"],[116,"jruck","jruck/1507568977.png","2017-10-09 17:09:37.9667","2017-10-09 17:09:37.9667"],[117,"jruck","jruck/1507569559.png","2017-10-09 17:19:19.437227","2017-10-09 17:19:19.437227"],[118,"pasquale","pasquale/1507569692.png","2017-10-09 17:21:32.786322","2017-10-09 17:21:32.786322"],[119,"wojtek","wojtek/1507569821.png","2017-10-09 17:23:41.881728","2017-10-09 17:23:41.881728"],[120,"wojtek","wojtek/1507570313.png","2017-10-09 17:31:54.48093","2017-10-09 17:31:54.48093"],[121,"pasquale","pasquale/1507570882.png","2017-10-09 17:41:22.887961","2017-10-09 17:41:22.887961"],[122,"pasquale","pasquale/1507571094.png","2017-10-09 17:44:54.329082","2017-10-09 17:44:54.329082"],[123,"ben","ben/1507571468.png","2017-10-09 17:51:08.458227","2017-10-09 17:51:08.458227"],[124,"ben","ben/1507571893.png","2017-10-09 17:58:13.577836","2017-10-09 17:58:13.577836"],[125,"pasquale","pasquale/1507572352.png","2017-10-09 18:05:53.197767","2017-10-09 18:05:53.197767"],[126,"tida","tida/1507575193.png","2017-10-09 18:53:14.02979","2017-10-09 18:53:14.02979"],[127,"tida","tida/1507575714.png","2017-10-09 19:01:54.491638","2017-10-09 19:01:54.491638"],[128,"kunal","kunal/1507576366.png","2017-10-09 19:12:46.355972","2017-10-09 19:12:46.355972"],[129,"jacob","jacob/1507579142.png","2017-10-09 19:59:02.42888","2017-10-09 19:59:02.42888"],[130,"chase","chase/1507581451.png","2017-10-09 20:37:32.018186","2017-10-09 20:37:32.018186"],[131,"pasquale","pasquale/1507583463.png","2017-10-09 21:11:03.309464","2017-10-09 21:11:03.309464"],[132,"setpixel","setpixel/1507583732.png","2017-10-09 21:15:32.745013","2017-10-09 21:15:32.745013"],[133,"pasquale","pasquale/1507583943.png","2017-10-09 21:19:03.908889","2017-10-09 21:19:03.908889"],[134,"chase","chase/1507584150.png","2017-10-09 21:22:30.856687","2017-10-09 21:22:30.856687"],[135,"pasquale","pasquale/1507584631.png","2017-10-09 21:30:32.168165","2017-10-09 21:30:32.168165"],[136,"caitlin","caitlin/1507584781.png","2017-10-09 21:33:01.499018","2017-10-09 21:33:01.499018"],[137,"pasquale","pasquale/1507584981.png","2017-10-09 21:36:21.367297","2017-10-09 21:36:21.367297"],[138,"pasquale","pasquale/1507585203.png","2017-10-09 21:40:03.159996","2017-10-09 21:40:03.159996"],[139,"jacob","jacob/1507586905.png","2017-10-09 22:08:25.70503","2017-10-09 22:08:25.70503"],[140,"kunal","kunal/1507587125.png","2017-10-09 22:12:05.688802","2017-10-09 22:12:05.688802"],[141,"niekdekker","niekdekker/1507587248.png","2017-10-09 22:14:09.266592","2017-10-09 22:14:09.266592"],[142,"ben_d","ben_d/1507587634.png","2017-10-09 22:20:34.737804","2017-10-09 22:20:34.737804"],[143,"caitlin","caitlin/1507588589.png","2017-10-09 22:36:29.481842","2017-10-09 22:36:29.481842"],[144,"caitlin","caitlin/1507592259.png","2017-10-09 23:37:40.106096","2017-10-09 23:37:40.106096"],[145,"caitlin","caitlin/1507593823.png","2017-10-10 00:03:43.459","2017-10-10 00:03:43.459"],[146,"pasquale","pasquale/1507597807.png","2017-10-10 01:10:08.181235","2017-10-10 01:10:08.181235"],[147,"pasquale","pasquale/1507602761.png","2017-10-10 02:32:41.485888","2017-10-10 02:32:41.485888"],[148,"caitlin","caitlin/1507604131.png","2017-10-10 02:55:31.277454","2017-10-10 02:55:31.277454"],[149,"chopeh","chopeh/1507625584.png","2017-10-10 08:53:04.270358","2017-10-10 08:53:04.270358"],[150,"frederique","frederique/1507640349.png","2017-10-10 12:59:10.188564","2017-10-10 12:59:10.188564"],[151,"wojtek","wojtek/1507644305.png","2017-10-10 14:05:05.544476","2017-10-10 14:05:05.544476"],[152,"kunal","kunal/1507647816.png","2017-10-10 15:03:36.569168","2017-10-10 15:03:36.569168"],[153,"pasquale","pasquale/1507650184.png","2017-10-10 15:43:05.180789","2017-10-10 15:43:05.180789"],[154,"pasquale","pasquale/1507650644.png","2017-10-10 15:50:44.838204","2017-10-10 15:50:44.838204"],[155,"pasquale","pasquale/1507650769.png","2017-10-10 15:52:49.341402","2017-10-10 15:52:49.341402"],[156,"pasquale","pasquale/1507651737.png","2017-10-10 16:08:58.119697","2017-10-10 16:08:58.119697"],[157,"pasquale","pasquale/1507651927.png","2017-10-10 16:12:07.58813","2017-10-10 16:12:07.58813"],[158,"pasquale","pasquale/1507652476.png","2017-10-10 16:21:16.801061","2017-10-10 16:21:16.801061"],[159,"kunal","kunal/1507654171.png","2017-10-10 16:49:31.220715","2017-10-10 16:49:31.220715"],[160,"pasquale","pasquale/1507654505.png","2017-10-10 16:55:05.224958","2017-10-10 16:55:05.224958"],[161,"pasquale","pasquale/1507654961.png","2017-10-10 17:02:41.222261","2017-10-10 17:02:41.222261"],[162,"caitlin","caitlin/1507657621.png","2017-10-10 17:47:01.845589","2017-10-10 17:47:01.845589"],[163,"pasquale","pasquale/1507658896.png","2017-10-10 18:08:16.796625","2017-10-10 18:08:16.796625"],[164,"pasquale","pasquale/1507659497.png","2017-10-10 18:18:17.707317","2017-10-10 18:18:17.707317"],[165,"wojtek","wojtek/1507669199.png","2017-10-10 20:59:59.534782","2017-10-10 20:59:59.534782"],[166,"pasquale","pasquale/1507669325.png","2017-10-10 21:02:06.60692","2017-10-10 21:02:06.60692"],[167,"wojtek","wojtek/1507669338.png","2017-10-10 21:02:18.6629","2017-10-10 21:02:18.6629"],[168,"tida","tida/1507670544.png","2017-10-10 21:22:25.982135","2017-10-10 21:22:25.982135"],[169,"Lagonk","Lagonk/1507671168.png","2017-10-10 21:32:48.505417","2017-10-10 21:32:48.505417"],[170,"jacob","jacob/1507671279.png","2017-10-10 21:34:39.338585","2017-10-10 21:34:39.338585"],[171,"Lagonk","Lagonk/1507671509.png","2017-10-10 21:38:29.414864","2017-10-10 21:38:29.414864"],[172,"Lagonk","Lagonk/1507671856.png","2017-10-10 21:44:16.129567","2017-10-10 21:44:16.129567"],[173,"Lagonk","Lagonk/1507672100.png","2017-10-10 21:48:20.327358","2017-10-10 21:48:20.327358"],[174,"pasquale","pasquale/1507674475.png","2017-10-10 22:27:56.035948","2017-10-10 22:27:56.035948"],[175,"wojtek","wojtek/1507675904.png","2017-10-10 22:51:44.470757","2017-10-10 22:51:44.470757"],[176,"jacob","jacob/1507676107.png","2017-10-10 22:55:07.947289","2017-10-10 22:55:07.947289"]]}

    data[:values].each do |row|
      user = User.find_by(username: row[1])

      unless user.present?
        user = User.create(username: row[1], password: "football", password_confirmation: "football")
        puts "Created #{user.username} with password football."
      end

      IO.copy_stream(open("http://screenhole.s3.amazonaws.com/#{row[2]}"), "tmp/backport/#{row[0]}.png")

      new_filename = "#{Shot.hashid.encode(user.id)}/#{Time.parse(row[3]).to_i}.png"

      obj = AWS_S3_BUCKET.object(new_filename)
      obj.upload_file("tmp/backport/#{row[0]}.png", acl: 'public-read')

      shot = user.shots.new
      shot.image_path = obj.key

      shot.save
    end
  end
end
